<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SF Pro Toolkit</title>
  <link rel="stylesheet" href="side-panel.css">
</head>
<body>
  <div class="side-panel-container">
    <!-- Header -->
    <div class="side-panel-header">
      <div class="header-content">
        <button class="header-btn" id="helpBtn" data-i18n-title="helpBtn" title="Help">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
        </button>
        <div class="header-title-group">
          <svg class="header-logo" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
            <polyline points="7.5 4.21 12 6.81 16.5 4.21"/>
            <polyline points="7.5 19.79 7.5 14.6 3 12"/>
            <polyline points="21 12 16.5 14.6 16.5 19.79"/>
            <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
            <line x1="12" y1="22.08" x2="12" y2="12"/>
          </svg>
          <h1 class="header-title" data-i18n="headerTitle">SF Pro Toolkit</h1>
        </div>
        <div class="profile-switcher">
          <button class="profile-dropdown" id="profileDropdownBtn">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
            <span id="currentProfileName">Default</span>
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </button>
          <div class="profile-menu" id="profileMenu">
            <!-- Populated dynamically -->
          </div>
        </div>
      </div>
    </div>

    <!-- Global Search -->
    <div class="search-bar">
      <svg class="search-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"/>
        <path d="m21 21-4.35-4.35"/>
      </svg>
      <input 
        type="text" 
        id="globalSearch" 
        class="search-input" 
        placeholder="Search environments, shortcuts, notes..."
        data-i18n-placeholder="globalSearchPlaceholder"
      >
      <span class="keyboard-hint" id="searchKeyboardHint">‚åòK</span>
      <button class="search-clear" id="clearSearch" style="display: none;">√ó</button>
    </div>

    <!-- Current Instance Card -->
    <div class="instance-card" id="instanceCard" style="display: none;">
      <div class="instance-info">
        <span class="instance-emoji" id="instanceEmoji"></span>
        <div class="instance-details">
          <div class="instance-type" id="instanceType"></div>
          <div class="instance-meta" id="instanceMeta"></div>
        </div>
      </div>
    </div>

    <!-- Environments Section -->
    <section class="section">
      <div class="section-header">
        <div>
          <h2 class="section-title">ENVIRONMENTS</h2>
          <p class="section-desc">Switch between Production, Preview, Sales, and Sandbox instances</p>
        </div>
        <button class="btn-add" id="addEnvBtn" title="Add Environment">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
        </button>
      </div>
      
      <div class="table-container">
        <table class="data-table" id="environmentsTable">
          <tbody id="environmentList">
            <tr class="empty-row">
              <td colspan="4">
                <div class="empty-state">
                  <p>No saved environments</p>
                  <button class="btn btn-secondary btn-sm" id="addEnvBtnInline">+ Add Current Instance</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Combined Links & Notes Section -->
    <section class="section">
      <div class="section-header">
        <div>
          <h2 class="section-title">LINKS & NOTES</h2>
          <p class="section-desc">Quick links and reference information</p>
        </div>
      </div>
      
      <!-- Shortcuts Subsection -->
      <div style="margin-bottom: 16px;">
        <div class="section-header" style="margin-bottom: 8px;">
          <div>
            <h3 style="font-size: 10px; font-weight: 700; letter-spacing: 0.8px; color: var(--text-tertiary); margin-bottom: 2px;">SHORTCUTS</h3>
          </div>
          <button class="btn-add" id="addShortcutBtn" title="Add Shortcut" style="width: 28px; height: 28px;">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
          </button>
        </div>
        <div class="table-container">
          <table class="data-table" id="shortcutsTable">
            <tbody id="shortcutsList">
              <tr class="empty-row">
                <td colspan="4">
                  <div class="empty-state">
                    <p>No shortcuts</p>
                    <button class="btn btn-secondary btn-sm" id="addCurrentPageBtnEmpty">+ Add Current Page</button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Notes Subsection -->
      <div>
        <div class="section-header" style="margin-bottom: 8px;">
          <div>
            <h3 style="font-size: 10px; font-weight: 700; letter-spacing: 0.8px; color: var(--text-tertiary); margin-bottom: 2px;">SCRATCH NOTES</h3>
          </div>
          <button class="btn-add" id="addNoteBtn" title="Add Note" style="width: 28px; height: 28px;">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
          </button>
        </div>
        <div class="table-container">
          <table class="data-table" id="notesTable">
            <tbody id="notesList">
              <tr class="empty-row">
                <td colspan="4">
                  <div class="empty-state">
                    <p>No notes</p>
                    <button class="btn btn-secondary btn-sm" id="addNoteBtnEmpty">+ Add Note</button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Sticky Footer -->
    <footer class="sticky-footer">
      <button class="footer-btn" id="footerSettingsBtn" title="Settings">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"/>
          <path d="M12 1v6m0 6v6M5.6 5.6l4.2 4.2m4.2 4.2l4.2 4.2M1 12h6m6 0h6M5.6 18.4l4.2-4.2m4.2-4.2l4.2-4.2"/>
        </svg>
        <span class="footer-btn-label">Settings</span>
      </button>
      <button class="footer-btn" id="footerDiagnosticsBtn" title="Diagnostics">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="16" x2="12" y2="12"/>
          <line x1="12" y1="8" x2="12.01" y2="8"/>
        </svg>
        <span class="footer-btn-label">Diagnostics</span>
      </button>
      <button class="footer-btn" id="footerThemeBtn" title="Toggle Theme" data-theme-active="false">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
        <span class="footer-btn-label">Theme</span>
      </button>
    </footer>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>
  </div>

  <!-- Add Environment Modal -->
  <div class="modal" id="addEnvModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 data-i18n="addEnvironmentTitle">Add Environment</h3>
        <button class="modal-close" id="closeAddEnvModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="addEnvForm">
          <div class="form-group">
            <label for="envName"><span data-i18n="environmentName">Environment Name</span> <span data-i18n="required">*</span></label>
            <input type="text" id="envName" data-i18n-placeholder="environmentNamePlaceholder" placeholder="e.g., Production DC68" required>
          </div>
          <div class="form-group">
            <label for="envType"><span data-i18n="environmentType">Environment Type</span> <span data-i18n="required">*</span></label>
            <select id="envType" required>
              <option value="production">üî¥ Production</option>
              <option value="preview">üü¢ Preview</option>
              <option value="sales">üü† Sales/Demo</option>
              <option value="sandbox">üü£ Sandbox</option>
            </select>
          </div>
          <div class="form-group">
            <label for="envHostname"><span data-i18n="hostname">Hostname</span> <span data-i18n="required">*</span></label>
            <input type="text" id="envHostname" data-i18n-placeholder="hostnamePlaceholder" placeholder="e.g., hcm-us20.hr.cloud.sap" required>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="cancelAddEnvBtn" data-i18n="cancel">Cancel</button>
        <button class="btn btn-primary" id="saveEnvBtn" data-i18n="saveEnvironment">Save</button>
      </div>
    </div>
  </div>

  <!-- Add Shortcut Modal -->
  <div class="modal" id="addShortcutModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 data-i18n="addShortcutTitle">Add Shortcut</h3>
        <button class="modal-close" id="closeAddShortcutModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="addShortcutForm">
          <div class="form-group">
            <label for="shortcutName"><span data-i18n="shortcutName">Name</span> *</label>
            <input type="text" id="shortcutName" placeholder="e.g., Admin Center" required>
          </div>
          <div class="form-group">
            <label for="shortcutPath"><span data-i18n="shortcutUrl">URL</span> *</label>
            <input type="text" id="shortcutPath" placeholder="e.g., https://... or /sf/admin" required>
            <small style="color: var(--text-secondary); font-size: 11px; display: block; margin-top: 4px;">
              Use relative URLs (e.g., /sf/admin) or absolute URLs (e.g., https://...)
            </small>
          </div>
          <div class="form-group">
            <label for="shortcutNotes">Notes</label>
            <input type="text" id="shortcutNotes" placeholder="Optional description">
          </div>
          <div class="form-group">
            <label for="shortcutTags">Tags (comma-separated)</label>
            <input type="text" id="shortcutTags" placeholder="e.g., SuccessFactors, Admin, Configuration">
            <small style="font-size: 10px; color: var(--text-tertiary); display: block; margin-top: 4px;">
              Use tags to organize and search shortcuts
            </small>
          </div>
          <div class="form-group">
            <label for="shortcutIcon">Icon</label>
            <select id="shortcutIcon">
              <option value="0">üó∫Ô∏è Map</option>
              <option value="1">‚öôÔ∏è Settings</option>
              <option value="2">üîê Security</option>
              <option value="3">üë• People</option>
              <option value="4">üìä Analytics</option>
              <option value="5">üõ†Ô∏è Tools</option>
              <option value="6">üìù Document</option>
              <option value="7">üéØ Target</option>
              <option value="8">üìÑ Page</option>
              <option value="9">üîó Link</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="cancelAddShortcutBtn">Cancel</button>
        <button class="btn btn-primary" id="saveShortcutBtn">Save</button>
      </div>
    </div>
  </div>

  <!-- Add Note Modal -->
  <div class="modal" id="addNoteModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Scratch Note</h3>
        <button class="modal-close" id="closeAddNoteModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="addNoteForm">
          <div class="form-group">
            <label for="noteTitle">Title *</label>
            <input type="text" id="noteTitle" placeholder="e.g., Test User IDs" required>
          </div>
          <div class="form-group">
            <label for="noteContent">Content</label>
            <textarea id="noteContent" rows="6" placeholder="Paste IDs, URLs, configs..."></textarea>
          </div>
          <div class="form-group">
            <label for="noteTags">Tags (comma-separated)</label>
            <input type="text" id="noteTags" placeholder="e.g., Testing, Configuration, User-IDs">
            <small style="font-size: 10px; color: var(--text-tertiary); display: block; margin-top: 4px;">
              Use tags to organize and search notes
            </small>
          </div>
          <div class="form-group">
            <label for="noteIcon">Icon</label>
            <select id="noteIcon">
              <option value="0">üìù Note</option>
              <option value="1">üîë Key</option>
              <option value="2">üÜî ID</option>
              <option value="3">üîó Link</option>
              <option value="4">‚öôÔ∏è Settings</option>
              <option value="5">üìã Clipboard</option>
              <option value="6">üí° Idea</option>
              <option value="7">üìå Pin</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="cancelAddNoteBtn">Cancel</button>
        <button class="btn btn-primary" id="saveNoteBtn">Save</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal" id="settingsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>‚öôÔ∏è Settings</h3>
        <button class="modal-close" id="closeSettingsModal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="settings-section">
          <h4 style="font-size: 13px; font-weight: 600; margin-bottom: 12px; color: var(--text-primary);">Configuration Management</h4>
          <p style="font-size: 12px; line-height: 1.6; color: var(--text-secondary); margin-bottom: 16px;">
            Import or export your toolkit configuration (shortcuts, environments, notes).
          </p>
          <div style="display: flex; gap: 8px; margin-bottom: 12px;">
            <button class="btn btn-primary" id="importJsonBtn" style="flex: 1;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
              </svg>
              Import JSON
            </button>
            <button class="btn btn-secondary" id="exportJsonBtn" style="flex: 1;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17 8 12 3 7 8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
              </svg>
              Export JSON
            </button>
          </div>
          <p style="font-size: 11px; color: var(--text-tertiary); margin-top: 8px;">
            <a href="#" id="downloadTemplateLink" style="color: var(--accent-blue); text-decoration: none;">üì• Download template JSON</a>
          </p>
          <input type="file" id="importFileInput" accept=".json" style="display: none;">
        </div>
        
        <!-- Display Mode Switcher - DISABLED (Side Panel Only)
        <div class="settings-section" style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border-light);">
          <h4 style="font-size: 13px; font-weight: 600; margin-bottom: 12px; color: var(--text-primary);">Display Mode</h4>
          <p style="font-size: 12px; line-height: 1.6; color: var(--text-secondary); margin-bottom: 16px;">
            This extension operates in side panel mode only.
          </p>
        </div>
        -->
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="closeSettingsBtn">Close</button>
      </div>
    </div>
  </div>

  <!-- Help Modal -->
  <div class="modal" id="helpModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>About SAP Pro Toolkit</h3>
        <button class="modal-close" id="closeHelpModal">&times;</button>
      </div>
      <div class="modal-body">
        <p style="font-size: 12px; line-height: 1.6; color: var(--text-secondary); margin-bottom: 20px;">
          SAP Pro Toolkit helps SAP professionals work more efficiently by providing quick access to environments, shortcuts, and diagnostic tools.
        </p>
        
        <h4 style="font-size: 13px; font-weight: 600; margin-bottom: 10px; color: var(--text-primary);">Key Features</h4>
        <ul style="font-size: 12px; line-height: 1.8; color: var(--text-secondary); margin: 0; padding-left: 20px;">
          <li><strong>Side Panel</strong>: Always accessible on the right side while you work</li>
          <li><strong>Environment Switching</strong>: Quickly switch between Production, Preview, Sales instances</li>
          <li><strong>Smart URLs</strong>: Supports both relative SF paths and absolute external URLs</li>
          <li><strong>Scratch Notes</strong>: Store temporary IDs, URLs, and reference information</li>
          <li><strong>JSON Import/Export</strong>: Backup and share your configuration</li>
          <li><strong>System Diagnostics</strong>: Generate detailed reports for troubleshooting</li>
          <li><strong>Multi-language Support</strong>: Available in 10+ languages</li>
        </ul>
        
        <h4 style="font-size: 13px; font-weight: 600; margin: 20px 0 10px; color: var(--text-primary);">‚å®Ô∏è Keyboard Shortcuts</h4>
        <div class="keyboard-shortcuts-grid">
          <div class="shortcut-item">
            <kbd id="modKey1">‚åò</kbd><kbd>K</kbd>
            <span class="shortcut-desc">Focus search bar</span>
          </div>
          <div class="shortcut-item">
            <kbd id="modKey2">‚åò</kbd><kbd>N</kbd>
            <span class="shortcut-desc">Add new shortcut</span>
          </div>
          <div class="shortcut-item">
            <kbd id="modKey3">‚åò</kbd><kbd>M</kbd>
            <span class="shortcut-desc">Add new note</span>
          </div>
          <div class="shortcut-item">
            <kbd>‚Üë</kbd><kbd>‚Üì</kbd>
            <span class="shortcut-desc">Navigate items</span>
          </div>
          <div class="shortcut-item">
            <kbd>Tab</kbd>
            <span class="shortcut-desc">Navigate buttons</span>
          </div>
          <div class="shortcut-item">
            <kbd>Enter</kbd>
            <span class="shortcut-desc">Open selected item</span>
          </div>
          <div class="shortcut-item">
            <kbd>Esc</kbd>
            <span class="shortcut-desc">Close modal/clear search</span>
          </div>
        </div>
        
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" id="closeHelpBtn">Got it!</button>
      </div>
    </div>
  </div>

  <!-- Diagnostics Modal -->
  <div class="modal modal-large" id="diagnosticsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>System Diagnostics</h3>
        <button class="modal-close" id="closeDiagnosticsModal">&times;</button>
      </div>
      <div class="modal-body">
        <div id="diagnosticsContent" class="diagnostics-content">
          <div class="diagnostics-loading">
            <div class="spinner"></div>
            <span>Gathering diagnostics...</span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="closeDiagnosticsBtn">Close</button>
        <button class="btn btn-primary" id="copyAllDiagnosticsBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
          </svg>
          Copy All
        </button>
      </div>
    </div>
  </div>

  <script src="toolkit-core.js"></script>
  <script src="side-panel.js"></script>
</body>
</html>
